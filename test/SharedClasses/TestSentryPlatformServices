using System;
using NUnit.Framework;
using Sentry.Unity.NativeUtils;

// Important: The 'SetUpFixture' applies to all tests in the same namespace. Since this is in `/Shared` we want this in the global namespace.

[SetUpFixture]
public class TestSentryPlatformServices
{
    [OneTimeSetUp]
    public void OneTimeSetUp()
    {

        // This is a bit hacky but: SentryPlatformServices are set up in 'SentryInitialization.cs' via the 'RuntimeInitializeOnLoadMethod' attribute.
        // Depending on where and what tests run - i.e. Editor Tests - this attribute is not triggered.
        // This is a fallback to prevent the tests from failing.
        // Tests that rely on specific services provide them via the SentryUnityOptions' internal constructor.
        try
        {
            _ = SentryPlatformServices.UnityInfo;
        }
        catch (InvalidOperationException)
        {
            SentryPlatformServices.UnityInfo = new TestUnityInfo();
        }
    }
}